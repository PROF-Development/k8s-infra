apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: api-strip
  namespace: prof-test-apps
spec:
  replacePathRegex:
    regex: "^/v1/([^/]+)(/.*)?"
    replacement: "/api/v1/$1$2"

---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: force-https
  namespace: prof-test-apps
spec:
  headers:
    customRequestHeaders:
      X-Forwarded-Proto: "https"
      X-Forwarded-Scheme: "https"
      X-Forwarded-Port: "443"
    sslProxyHeaders:
      X-Forwarded-Proto: "https"
